# Migration `20200611205053-init`

This migration has been generated by g4rcez at 6/11/2020, 8:50:53 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."protocol" ADD COLUMN "server_id" text  NOT NULL ,
ADD COLUMN "targetId" text   ;

ALTER TABLE "public"."_protocolToserver" DROP CONSTRAINT IF EXiSTS "_protocolToserver_A_fkey";

ALTER TABLE "public"."_protocolToserver" DROP CONSTRAINT IF EXiSTS "_protocolToserver_B_fkey";

ALTER TABLE "public"."protocol" ADD FOREIGN KEY ("server_id")REFERENCES "public"."server"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."protocol" ADD FOREIGN KEY ("targetId")REFERENCES "public"."target"("id") ON DELETE SET NULL  ON UPDATE CASCADE

DROP TABLE "public"."_protocolToserver";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200611203203-init..20200611205053-init
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://postgres:12345@localhost:5432/prettycool?schema=public"
 }
 generator client {
   provider = "prisma-client-js"
@@ -14,8 +14,9 @@
   id            String          @default(uuid()) @id
   company_name  String
   domain        String          @unique
   company_email company_email[]
+  protocol      protocol[]
 }
 model company_email {
   id          String @default(uuid()) @id
@@ -25,12 +26,15 @@
   target_id   String
 }
 model protocol {
-  id           String   @default(uuid()) @id
+  id           String  @default(uuid()) @id
   service_name String
   port         Int
-  server       server[]
+  server_id    String
+  server       server  @relation(fields: [server_id], references: [id])
+  target       target? @relation(fields: [targetId], references: [id])
+  targetId     String?
 }
 model server {
   id          String     @default(uuid()) @id
```


