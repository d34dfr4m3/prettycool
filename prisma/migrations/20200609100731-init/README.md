# Migration `20200609100731-init`

This migration has been generated by g4rcez at 6/9/2020, 10:07:31 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."target" (
"company_name" text  NOT NULL ,"domain" text  NOT NULL ,"id" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."company_email" (
"email" text  NOT NULL ,"id" text  NOT NULL ,"service_url" text  NOT NULL ,"target_id" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."protocol" (
"id" text  NOT NULL ,"port" integer  NOT NULL ,"service_name" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."server" (
"id" text  NOT NULL ,"ip" text  NOT NULL ,"ip_version" text  NOT NULL ,"location_id" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."location" (
"city" text   ,"continent" text  NOT NULL ,"country" text  NOT NULL ,"country_code" text  NOT NULL ,"id" text  NOT NULL ,"latitude" Decimal(65,30)  NOT NULL ,"longitude" Decimal(65,30)  NOT NULL ,"province" text   ,"timezone" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_protocolToserver" (
"A" text  NOT NULL ,"B" text  NOT NULL )

ALTER TABLE "public"."CompanyEmail" DROP CONSTRAINT IF EXiSTS "CompanyEmail_targetId_fkey";

CREATE UNIQUE INDEX "target.domain" ON "public"."target"("domain")

CREATE UNIQUE INDEX "company_email.service_url" ON "public"."company_email"("service_url")

CREATE UNIQUE INDEX "_protocolToserver_AB_unique" ON "public"."_protocolToserver"("A","B")

CREATE  INDEX "_protocolToserver_B_index" ON "public"."_protocolToserver"("B")

ALTER TABLE "public"."company_email" ADD FOREIGN KEY ("target_id")REFERENCES "public"."target"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."server" ADD FOREIGN KEY ("location_id")REFERENCES "public"."location"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_protocolToserver" ADD FOREIGN KEY ("A")REFERENCES "public"."protocol"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_protocolToserver" ADD FOREIGN KEY ("B")REFERENCES "public"."server"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."CompanyEmail";

DROP TABLE "public"."Target";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200607135754-init..20200609100731-init
--- datamodel.dml
+++ datamodel.dml
@@ -2,26 +2,55 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://postgres:12345@localhost:5432/prettycool?schema=public"
 }
 generator client {
   provider = "prisma-client-js"
 }
-model Target {
-  id           String         @default(uuid()) @id
-  companyName  String
-  domain       String
-  CompanyEmail CompanyEmail[]
+model target {
+  id            String          @default(uuid()) @id
+  company_name  String
+  domain        String          @unique
+  company_email company_email[]
 }
-model CompanyEmail {
-  id         String @default(uuid()) @id
-  email      String
-  serviceUrl String @unique
+model company_email {
+  id          String @default(uuid()) @id
+  email       String
+  service_url String @unique
+  target      target @relation(fields: [target_id], references: [id])
+  target_id   String
+}
-  target   Target @relation(fields: [targetId], references: [id])
-  targetId String
+model protocol {
+  id           String   @default(uuid()) @id
+  service_name String
+  port         Int
+  server       server[]
 }
+
+model server {
+  id          String     @default(uuid()) @id
+  ip          String
+  ip_version  String
+  location_id String
+  // protocol_id String
+  protocols   protocol[]
+  location    location   @relation(fields: [location_id], references: [id])
+}
+
+model location {
+  id           String   @default(uuid()) @id
+  country      String
+  longitude    Float
+  province     String?
+  city         String?
+  latitude     Float
+  timezone     String
+  continent    String
+  country_code String
+  server       server[]
+}
```


